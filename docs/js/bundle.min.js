"use strict";function mealClass(o){function r(){var t=this;t.id=create_UUID(),t.name="",t.duration=0,t.steps=[]}return r.prototype.convertStepsToDuration=function(){var e=0;this.steps.forEach(function(t){return e+=t.duration}),this.duration=e},r.prototype.formattedDuration=function(){return Math.floor(this.duration%864e5/36e5)+"h "+Math.floor(this.duration%36e5/6e4)+"m "+Math.floor(this.duration%6e4/1e3)+"s"},r.build=function(t){var e=new r;return t&&(e.id=t.id,e.name=t.name,e.steps=t.steps?t.steps.map(o.build):[],e.convertStepsToDuration()),e},r}function stepClass(){function o(){this.id="",this.name="",this.duration=0,this.hours=0,this.minutes=0,this.seconds=0}return o.prototype.parseDuration=function(){this.duration+=60*this.hours*60*1e3,this.duration+=60*this.minutes*1e3,this.duration+=1e3*this.seconds},o.prototype.formattedDuration=function(){return Math.floor(this.duration%864e5/36e5)+"h "+Math.floor(this.duration%36e5/6e4)+"m "+Math.floor(this.duration%6e4/1e3)+"s"},o.build=function(t){var e=new o;return t&&(e.id=t.id,e.name=t.name,e.hours=t.hours,e.minutes=t.minutes,e.seconds=t.seconds,e.parseDuration()),e},o}function mealService(t,r,n,a){function i(){var t=angular.fromJson(n.localStorage.meals);return t||[]}return{get:i,getById:function(t){var e=i().map(a.build),o=r("filter")(e,{id:t});return 1!==o.length?a.build():a.build(o[0])},post:function(t){var e=angular.fromJson(n.localStorage.meals);e||(e=[]);var o=e.map(function(t){return t.id}).indexOf(t.id);-1<o?e[o]=t:e.push(t),n.localStorage.meals=angular.toJson(e)}}}var thymerApp=angular.module("thymerApp",["ngRoute"]);function create_UUID(){var o=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=(o+16*Math.random())%16|0;return o=Math.floor(o/16),("x"==t?e:3&e|8).toString(16)})}angular.module("thymerApp").factory("stepClass",stepClass),angular.module("thymerApp").factory("mealClass",["stepClass",mealClass]),angular.module("thymerApp").factory("mealService",["$http","$filter","$window","mealClass",mealService]),thymerApp.config(["$routeProvider",function(t){t.when("/",{templateUrl:"../templates/_Home.html",controller:"homeController"}).when("/New",{templateUrl:"../templates/_Edit.html",controller:"editController"}).when("/Edit/:id",{templateUrl:"../templates/_Edit.html",controller:"editController"}).when("/Run/:id",{templateUrl:"../templates/_Run.html",controller:"runController"}).otherwise({redirectTo:"/"})}]),angular.module("thymerApp").controller("editController",["$scope","$routeParams","$location","$filter","mealService","mealClass","stepClass",function(e,t,o,r,n,a,i){e.id=t.id,e.meal=a.build(),e.addStep=function(){e.meal.steps.push(i.build())},e.removeStep=function(t){e.meal.steps.splice(t,1)},e.saveMeal=function(){e.meal.convertStepsToDuration(),n.post(e.meal),o.path("/")},e.goBack=function(){o.path("/")},e.meal=n.getById(e.id)}]),angular.module("thymerApp").controller("homeController",["$scope","$location","$filter","mealService","mealClass",function(t,e,o,r,n){t.meals=[],t.goAdd=function(){e.path("/New")},t.goEdit=function(t){e.path("/Edit/"+t)},t.goRun=function(t){e.path("/Run/"+t)},t.meals=r.get().map(n.build)}]),angular.module("thymerApp").controller("runController",["$scope","$location","$filter","mealService","mealClass",function(t,e,o,r,n){t.meal=n.build(),t.goRun=function(){},t.goEdit=function(t){e.path("/Edit/"+t)},t.meal=r.getById(t.id)}]);